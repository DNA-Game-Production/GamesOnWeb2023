import{FreeCamera,HemisphericLight,MeshBuilder,Scene,Sprite,SpriteManager,StandardMaterial,Texture,Vector3}from"babylonjs";import{canvas,engine,scene,sphere1}from"./main";import{createWall}from"./tools";export var light;export var gravity;export function createScene(){var scene=new Scene(engine);window.scene=scene;createCamera();createLight();createGround();createWall();createSprites();gravity=-0.02;scene.collisionsEnabled=true;scene.beforeRender=()=>{sphere1?.isJumping?applyJump():applyGravity()};return scene};function createCamera(){var camera=new FreeCamera("camera1",new Vector3(0,5,-10),scene);camera.setTarget(Vector3.Zero());camera.attachControl(canvas,true)}function createLight(){light=new HemisphericLight("light1",new Vector3(0,1,0),scene);light.intensity=0.7}function createGround(){var ground=MeshBuilder.CreateGround("ground1",{width:50,height:50,subdivisions:2},scene);const groundMaterial=new StandardMaterial("groundMaterial",scene);groundMaterial.diffuseTexture=new Texture("./img/grass.png");ground.material=groundMaterial;ground.checkCollisions=true}function createSprites(){var spriteManagerTrees=new SpriteManager("grassesManager","./img/herb.png",2000,800,scene);for(var i=0;i<2000;i++){let herb=new Sprite("herb",spriteManagerTrees);herb.height=Math.random()*2;herb.width=Math.random()*2;herb.position.x=Math.random()*50-25;herb.position.z=Math.random()*50-25;herb.position.y=0.5}}function applyGravity(){if(sphere1){var hits=scene.multiPickWithRay(sphere1.ray,m=>{return m.isPickable});var filtered=hits?.filter(e=>e.pickedMesh?.name!==sphere1?.sphere.name);if(filtered!==undefined&&filtered.length>0){var hit=filtered[0];if(hit!==null&&hit.pickedPoint&&sphere1.position.y>hit.pickedPoint.y+1.2){sphere1.position.y+=gravity}}else{sphere1.position.y+=gravity*4}}}function applyJump(){if(sphere1){var hits=scene.multiPickWithRay(sphere1.jumpRay,m=>{return m.isPickable});var filtered=hits?.filter(e=>e.pickedMesh?.name!==sphere1?.sphere.name);if(filtered!==undefined&&filtered.length>0){var hit=filtered[0];if(hit!==null&&hit.pickedPoint&&sphere1.position.y<hit.pickedPoint.y-1.2){sphere1.position.y-=gravity}}else{sphere1.position.y-=gravity*6}}}
//# sourceMappingURL=scene.js.map